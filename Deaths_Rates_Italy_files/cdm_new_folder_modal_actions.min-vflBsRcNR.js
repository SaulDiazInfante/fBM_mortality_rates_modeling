define(["require","exports","tslib","modules/clean/sharing/access_level","modules/clean/sharing/api/client","modules/clean/sharing/ui_util","modules/clean/sharing/api","modules/clean/api_v2/error","modules/clean/legacy_pyxl_controllers/ajax_form","modules/core/i18n","modules/clean/api_v2/types","modules/clean/web_user_action_logger","modules/clean/web_user_action_events"],function(e,n,o,a,r,t,s,l,i,c,u,d,_){"use strict";function m(e){var n=e.user,o=e.pathName,a=e.folderName,l=e.autoTeamGroupAccessLevel,c=e.autoTeamGroupId,u=e.showFileSystemWarningsModal,d=e.onPending,_=e.onComplete,m=e.onCancel,h=n.id,p=new r.FolderShareApiClient({userId:h,isNonUserRelativeContext:!1}),C=t.getNewFolderPathFromContentName(a,o);d(),new s.SharingApi(n).validate_new_sf_path(a,C,function(){f({userId:h,fqPath:C,autoTeamGroupAccessLevel:l,folderApiClient:p,autoTeamGroupId:c,showFileSystemWarningsModal:u,onComplete:function(){_({user:n,folderName:a,fqPath:C})},onCancel:m})},function(e){var n=i.default.extract_errors(e.responseText);m(n.folder_name&&n.folder_name.message_text)})}function f(e){var n=e.userId,o=e.fqPath,r=e.autoTeamGroupAccessLevel,t=e.folderApiClient,s=e.autoTeamGroupId,i=e.showFileSystemWarningsModal,c=e.onComplete,m=e.onCancel,f=r===a.ACCESS_LEVEL.READER;h({folderApiClient:t,showFileSystemWarningsModal:i,fqPath:o,confidential:f,onCancel:m}).then(function(e){var o=e.shared_folder_id;return f?(d.WebUserActionLog.log(n,_.WebUserActionLogEvent.CONF_BY_CREATE_CONFIDENTIAL_FOLDER,{ns_id:o,who_has_access:_.WebUserActionLogExtraValue.EVERYONE_GROUP_VIEW_ACCESS,location:_.WebUserActionLogExtraValue.BROWSE}),t.addMembers({contentId:o,members:[new u.UnionScalar("dropbox_id",s)],accessLevel:a.ACCESS_LEVEL.READER})):Promise.resolve()}).then(c).catch(l.catchApiError(function(){m()}))}function h(e){var n=e.folderApiClient,a=e.showFileSystemWarningsModal,r=e.onCancel,t=o.__rest(e,["folderApiClient","showFileSystemWarningsModal","onCancel"]);return a?n.shareWithFsws(o.__assign({},t,{folderPolicy:null})).then(function(e){var s=e.metadata,l=e.fsws;return l?new Promise(function(e,s){a({fsws:l,onFinalAccept:function(){n.share(o.__assign({},t,{folderPolicy:null})).then(e,s)},confirmText:c._("Create folder"),onAbortAction:r})}):Promise.resolve(s)}):n.shareWithoutFsws(o.__assign({},t,{folderPolicy:null})).then(function(e){var n=e.metadata;return Promise.resolve(n)})}Object.defineProperty(n,"__esModule",{value:!0}),i=o.__importDefault(i),n.createTSDPlus1NsfFolder=m,n._shareWithFsw=h});
//# sourceMappingURL=cdm_new_folder_modal_actions.min.js-vfl8TuA_w.map