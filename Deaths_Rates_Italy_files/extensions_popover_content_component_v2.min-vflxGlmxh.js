define(["require","exports","tslib","react","modules/core/i18n","modules/clean/react/css","spectrum/popover","modules/clean/static_urls","modules/clean/react/app_actions/redirect","modules/clean/react/file_viewer/unity/with_unity","modules/clean/react/file_viewer/constants","modules/clean/react/app_actions/byline","modules/clean/react/extensions/unity_and_cloud_editors","modules/clean/react/extensions/common","modules/clean/file_store/utils","spectrum/icon_action","modules/clean/react/extensions/data/helpers","modules/clean/react/extensions/extensions_scaling_modal","modules/clean/react/file_viewer/open_button/types","modules/clean/react/extensions/cloud_docs_compat"],function(e,t,n,o,a,r,i,c,s,l,p,u,d,m,f,_,v,y,E,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=n.__importDefault(o);var h=(function(e){function t(t){var n=e.call(this,t)||this;return n.createAppActionClickHandler=function(e){return function(){var t=n.props,o=t.file,a=t.user,r=t.featureFlags,i=t.telemetryContext,c=t.updateLinkState;if(s.redirectToActionOrShowAuth(a,o,e,r,i,c),"redirect"===e.handler[".tag"])m.logEvent(n.props.currentSession,"select_action",{action_id:e.id,encoded_app_id:e.app_id,menu_version:2});else if("cloud_editor"===e.handler[".tag"]){var l=g.isWopiAction(e)?E.OpenButtonAction.OPEN_WITH:E.OpenButtonAction.OPEN_WITH_CLOUD_DOC;m.logEvent(n.props.currentSession,"select_legacy_action",{type:l})}}},n.wrapperForAction=function(e){return{appAction:e,handler:n.createAppActionClickHandler(e),userAction:p.UserAction.OpenWithAppAction,actionName:e.description}},n.handleImgLoadError=function(){n.props.refreshAppIcons&&n.props.refreshAppIcons({user:n.props.user})},n.renderActionRow=function(e){var t=n.props,a=t.appIcons,r=t.categoryIdToInfos,s=t.currentSession,l=e.icon;void 0!==e.app_id&&(l=a[e.app_id]||l);var p,d=r[e.category];p=l.is_static?c.static_url("/static/images/generic_app_icon-vflIPYT1H.png"):l.url;var f=e.description,_=d.display_name,v=o.default.createElement(i.PopoverContentItem,{className:"app-action-row",key:e.id,value:n.wrapperForAction(e)},o.default.createElement("div",null,o.default.createElement("div",{className:"app-action-row-content"},o.default.createElement("img",{className:"app-action-popover-icon",src:p,alt:"",onError:n.handleImgLoadError}),o.default.createElement("div",{className:"app-action-popover-item-info"},f)),o.default.createElement("div",{className:"app-action__inline-value-description"},_))),y=e.app_copy&&e.app_copy.length>0?e.app_copy:void 0;return o.default.createElement(u.ExtensionsBylineTooltip,{bylines:y,onDidShow:m.handleShowByline(e.app_id,s),key:e.id},v)},n.renderDownload=function(e){var t=n.props.telemetryContext;return t&&"previews"===t.surface?o.default.createElement(i.PopoverItemGroup,{className:"app-action-category-group",key:"download"},o.default.createElement(i.PopoverContentItem,{key:"download",value:e,className:"app-action-row"},o.default.createElement("div",{className:"app-action-row-content"},o.default.createElement(_.IconAction,{className:"app-action-popover-icon-svg",name:"download"}),o.default.createElement("span",{className:"app-action-legacy-option-text"},a._("Download"))))):null},n}return n.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.user,r=t.file,c=t.appActions,s=t.openOptions,l=t.bylines,p=t.categoryIdToInfos,u=t.featureFlags,f=t.currentSession,_=t.telemetryContext,E=t.updateLinkState,g=m.getOpenOptionsWithLogging(s,f),h=v.partitionOptions(g),w=h.unityOptions,A=h.cloudEditorOptions,N=h.downloadOption,I=v.partitionActions(c),O=I.cloudEditors,x=I.installedActions,P=I.promotedActions,S=I.unpromotedActions,C=x.length>0,k=P.length>0,W=S.length>0;return o.default.createElement("div",null,o.default.createElement(d.UnityAndCloudEditors,{unityOptions:w,legacyCloudEditorOptions:A,cloudEditorAppActions:O.map(function(t){return e.wrapperForAction(t)}),bylines:l,currentSession:f}),C&&o.default.createElement(i.PopoverItemGroup,{className:"app-action-category-group",key:"installed-actions"},x.map(function(t){return e.renderActionRow(t)}),o.default.createElement(i.PopoverItemGroupSeparator,{className:"app-action-menu-separator"})),(k||W)&&o.default.createElement(i.PopoverItemGroup,{className:"app-action-category-group",key:"promoted-actions"},k&&o.default.createElement(i.PopoverItemGroupTitle,{className:"app-action-category-title"},C?a._("MORE APPS"):a._("APPS")),P.map(function(t){return e.renderActionRow(t)}),W&&o.default.createElement(i.PopoverContentItem,{key:a._("Show more"),value:{handler:function(){var e=x.concat(P,S);y.showExtensionsScalingModal(n,r,e,p,u,E,_,f),m.logEvent(f,"select_show_more",{surface:_&&_.surface})}},className:"app-action-row"},o.default.createElement("div",{className:"app-action-row-content"},o.default.createElement("span",{className:"app-action-popover-icon-svg"}),o.default.createElement("span",{className:"app-action-legacy-option-text"},k||C?a._("Show more"):a._("View apps")))),o.default.createElement(i.PopoverItemGroupSeparator,{className:"app-action-menu-separator"})),N&&this.renderDownload(N))},t})(o.default.Component);t.ExtensionsPopoverV2WithUnity=function(e){return f.isBrowseFile(e.file)?o.default.createElement(l.WithUnity,{file:e.file,user:e.user,render:function(t){return o.default.createElement(h,n.__assign({},e,{unityInfo:t}))}}):null},t.ExtensionsPopoverV2NoUnity=r.requireCssWithComponent(h,["/static/css/app_actions/index-vfl_lauE_.css"])});
//# sourceMappingURL=extensions_popover_content_component_v2.min.js-vflHivHPw.map