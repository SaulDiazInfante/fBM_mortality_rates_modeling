define(["require","exports","tslib","react","modules/core/browser","modules/clean/react/delorean/data/types","modules/clean/react/snackbar","modules/core/i18n","spectrum/icon_content","external/classnames","spectrum/icon_arrow","spectrum/tertiary_link","spectrum/button","modules/clean/react/delorean/data/api","modules/clean/react/delorean/components/rewind_step_header","modules/clean/react/delorean/logging","modules/clean/react/delorean/constants"],function(e,t,r,a,n,o,i,s,l,c,d,p,u,m,f,h,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r.__importDefault(a),n=r.__importStar(n),c=r.__importDefault(c),m=r.__importStar(m),h=r.__importStar(h);var w=function(e){var t=e.name,r=e.displayDate,n=e.previousVersion;return a.default.createElement("div",{className:c.default({"rewind-folder-and-date":!0,"rewind-folder-and-date--previous-version":n})},a.default.createElement("div",{className:"rewind-folder-and-date__folder"},a.default.createElement(l.IconContent,{name:"folder-small"})),a.default.createElement("div",null,a.default.createElement("div",{className:"rewind-folder-and-date__name"},t),a.default.createElement("div",{className:"rewind-folder-and-date__date"},r)))},v=(function(e){function t(t){var l=e.call(this,t)||this;return l.clickCancel=function(){var e=l.props,t=e.user,r=e.restoreId;h.clickPreviewCancel({user:t,restoreId:r}),l.props.dispatch({type:o.DeloreanActionType.changeRewindPageFromConfirmationPageToGraphPage,previousPage:l.props.page})},l.clickSendBack=function(){return r.__awaiter(l,void 0,void 0,function(){var e,t,n,l,c,d;return r.__generator(this,function(r){switch(r.label){case 0:e=this.props,t=e.user,n=e.restoreId,h.clickPreviewId({user:t,restoreId:n}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,m.beginRewind({path:this.props.fqpath,targetTsMicroseconds:1e3*this.props.eventToRewindTo.timestamp,user:this.props.user,restorationsLoggingId:this.props.restoreId})];case 2:return l=r.sent(),[3,4];case 3:if(c=r.sent(),d=c&&c.error&&c.error[".tag"])if("insufficient_permissions"===d)i.Snackbar.show(a.default.createElement(i.Snackbar,{closeButtonText:s._("Close"),title:s._("You do not have permissions to rewind this folder.",{project:"folder-history"}),variant:"fail"}));else{if("invalid_arguments"!==d&&"feature_not_allowed"!==d)throw c;i.Snackbar.show(a.default.createElement(i.Snackbar,{closeButtonText:s._("Close"),title:s._("We canâ€™t rewind that. Try again, or contact support.",{project:"folder-history"}),variant:"fail"}))}return[2];case 4:return this.props.dispatch({type:o.DeloreanActionType.changeRewindPageToRewindStarted,event:this.props.eventToDisplay,rewindId:l.rewind.id}),[2]}})})},l.onGoBack=function(){var e=l.props,t=e.user,r=e.restoreId;h.clickPreviewBack({user:t,restoreId:r}),l.props.dispatch({type:o.DeloreanActionType.goBackFromConfirmationPage})},l.goToHelp=function(){var e=l.props,t=e.user,r=e.restoreId;h.clickPreviewHelp({user:t,restoreId:r}),n.unsafe_open_tab("http://www.dropbox.com/help/security/rewind")},l.state={eventCountHigh:null},l}return r.__extends(t,e),t.prototype.componentDidMount=function(){h.loadConfirmationPage({eventToDisplay:this.props.eventToDisplay,eventToRewindTo:this.props.eventToRewindTo,eventCounts:this.props.eventCounts,graphPage:this.props.graphPage,user:this.props.user,restoreId:this.props.restoreId})},t.prototype.render=function(){return a.default.createElement("div",null,a.default.createElement(f.RewindStepHeader,{currentStep:3,maxStep:_.NUM_REWIND_STEPS,instructions:s._("Start rewinding?",{project:"folder-history",comment:"Rewinding is used as a verb"}),onGoBack:this.onGoBack}),a.default.createElement(w,{name:this.props.folderName,displayDate:s._("Now",{project:"folder-history",comment:"Refers to the current state of the folder. Keep to one word if possible."}),previousVersion:!0}),a.default.createElement("div",{className:"rewind-confirmation-change-count"},a.default.createElement("div",{className:"rewind-confirmation-change-count__arrow"},a.default.createElement("div",{className:"rewind-confirmation-change-count__arrow__vertical-line"}),a.default.createElement("div",{className:"rewind-confirmation-change-count__arrow__head"}))),a.default.createElement(w,{name:this.props.folderName,displayDate:this.props.eventToDisplay.confirmationCardDate,previousVersion:!1}),a.default.createElement("div",{className:"rewind-confirmation-explanation"},s._("Your files and folders will look like they did on %(time_ago)s",{project:"folder-history"}).format({time_ago:this.props.eventToDisplay.fullDate})," ",a.default.createElement("a",{href:"#",onClick:this.goToHelp},s._("How Rewind works")," ",a.default.createElement(d.IconArrow,{className:"arrow rewind-confirmation-explanation__arrow-icon",name:"right"}))),a.default.createElement("div",{className:"rewind-confirmation-buttons"},a.default.createElement(u.Button,{onClick:this.clickSendBack},s._("Rewind",{project:"folder-history",comment:"Button to start rewinding. Used as a verb."})),a.default.createElement(p.TertiaryLink,{onClick:this.clickCancel,className:"cancel"},s._("Cancel"))))},t})(a.default.Component);t.RewindConfirmationPage=v});
//# sourceMappingURL=rewind_confirmation_page.min.js-vfl3YnBxj.map