define(["require","exports","tslib","modules/clean/filepath","modules/clean/react/delorean/util","modules/constants/time","modules/clean/react/delorean/util","modules/core/i18n","modules/clean/viewer","modules/clean/datetime","modules/clean/datetime","modules/clean/react/delorean/data/tooltips","modules/clean/browse_interface","modules/core/uri","modules/clean/react/delorean/data/headings","modules/clean/react/delorean/data/types"],function(e,t,a,o,n,r,i,d,m,c,s,_,l,u,p,f){"use strict";function h(e){var t=e.getTime(),a=s.getTimeBands(Date.now());return t>=a.today?d._("Today",{project:"folder-history"}):t>=a.yesterday?d._("Yesterday",{project:"folder-history"}):s.nice_date_with_month_name(e,!0)}function v(e){return{type:f.DeloreanEventType.dateBanner,eventCardDate:h(e),date:n.floorDate(e)}}function y(e){return{type:f.DeloreanEventType.emptyDay,date:e,uid:n.getUid()}}function g(e){var t=e.eventPath,a=e.user;return void 0===t?void 0:""===t?m.Viewer.get_root_name(a):o.child_dir(t)}function b(e){var t=e.event,a=e.user,r=e.path,m=t.object_metadata;if("from_containing_path"in m&&"to_containing_path"in m){var c=g({eventPath:m.from_containing_path,user:a}),s=g({eventPath:m.to_containing_path,user:a});return d._("from %(src)s to %(dst)s",{project:"folder-history"}).format({src:c,dst:s})}if("from_containing_path"in m){var c=g({eventPath:m.from_containing_path,user:a});return d._("from %(location)s",{project:"folder-history"}).format({location:c})}if("to_containing_path"in m){var s=g({eventPath:m.to_containing_path,user:a});return o.normalize(m.to_containing_path)!==o.normalize(r)?d._("to %(location)s",{project:"folder-history"}).format({location:s}):void 0}if("containing_path"in m){var _=g({eventPath:m.containing_path,user:a});return o.normalize(m.containing_path)!==o.normalize(r)?d._("in %(location)s",{project:"folder-history"}).format({location:_}):void 0}if(!n.isMetadataType(m,"other"))return i.assertNever(m)}function j(e){var t=e.event,a=e.path,d=(e.currentFolder,e.user),m=0;if(t.object_metadata)if(n.isMetadataType(t.object_metadata,"single_object_metadata")||n.isMetadataType(t.object_metadata,"multi_object_metadata")||n.isMetadataType(t.object_metadata,"rename_metadata")||n.isMetadataType(t.object_metadata,"move_metadata")||n.isMetadataType(t.object_metadata,"move_in_metadata")||n.isMetadataType(t.object_metadata,"move_out_metadata")||n.isMetadataType(t.object_metadata,"rollback_metadata"))m=t.object_metadata.contents_count||0;else if(n.isMetadataType(t.object_metadata,"edit_metadata"))m=1;else{if(!n.isMetadataType(t.object_metadata,"other"))return i.assertNever(t.object_metadata);m=1}0===m&&(m=1);var s,v=new Date(t.timestamp_us/1e3),y=c.format_date(v,"MMM d, h:mm a"),g="%(date_name)s, %(month_abbr)s %(date_number)s at %(time)s".format({date_number:v.getDate(),date_name:n.dateNames[v.getDay()],month_abbr:c.month_name(v.getMonth(),!0),time:c.format_date(v,"h:mm a")}),j=o.normalize(n.getLocationOfMetadata(t.object_metadata)),T=t.actor.account_id===d.id,D=_.getTooltipForEvent({isYou:T,event:t,itemCount:m,path:a,relativeFolderDisplayPath:""}),M=p.getHeadlineForEvent({event:t,itemCount:m,isYou:T,user:d});s=n.isOpType(t.op_type,"delete")?new u.URI({scheme:"https",authority:"www.dropbox.com",path:"/deleted_files"}):l.browse_uri_for_fq_path(d,j);var w=b({event:t,user:d,path:a});return{type:f.DeloreanEventType.event,actor:t.actor,count:m,browseHref:s,eventCardDate:h(v),confirmationCardDate:y,fullDate:g,date:v,tooltip:D,uid:i.getUid(),eventHeadline:M,timestamp:v.getTime(),displayTooltip:D!==M,cardSubheading:w,operationName:n.getNameOfOpType(t.op_type),timeAgo:c.format_date(v,r.TIME_FORMAT)}}function T(e,t){return"personal"===e.role?t.is_paired?d._("Personal",{project:"folder-history"}):d._("Dropbox",{project:"folder-history"}):t.team_name}function D(e,t,a){return e.slice(e.length-t,e.length-a).reduce(function(e,t){return e+t.count},0)>0}Object.defineProperty(t,"__esModule",{value:!0}),o=a.__importStar(o),n=a.__importStar(n),r=a.__importStar(r),t.getEventCardDate=h,t.createDateBanner=v,t.createEmptyDay=y,t.getProcessedEvent=j,t.getRootFolderName=T,t.checkHasDataThisWeek=D});
//# sourceMappingURL=reducer_helpers.min.js-vflzrXpLf.map